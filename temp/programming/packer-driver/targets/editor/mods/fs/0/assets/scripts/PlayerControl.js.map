{"version":3,"sources":["file:///Volumes/WD%20Black/DRIVE/CURSOS/SEF/DESARROLLO%20DE%20VIDEOJUEGOS%20EN%20HTML5/JUEGOS/Cocos/TheJumpingWizard/assets/scripts/PlayerControl.ts"],"names":["_decorator","Component","director","systemEvent","SystemEvent","KeyCode","clamp","UITransform","Rect","Collider","ccclass","property","PlayerControl","start","on","EventType","KEY_DOWN","onKeyDown","KEY_UP","onKeyUp","getScene","addChild","player","collider","getComponent","onTriggerEnter","event","otherCollider","pla","node","destroy","keyCode","ARROW_UP","vMov","speed","ARROW_RIGHT","hMov","ARROW_LEFT","update","dt","move","clampPosition","pos","position","set","x","y","getScreenRect","sprite","canvas","parent","width","height","screenRect","xMin","xMax","yMin","yMax"],"mappings":"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","sourcesContent":["\nimport { _decorator, Component, director, systemEvent, game, SystemEvent, EventKeyboard, KeyCode, clamp, UITransform, Rect, Node, Prefab, instantiate, Collider, ICollisionEvent} from 'cc';\n\nconst { ccclass, property } = _decorator;\n \n@ccclass('PlayerControl')\nexport class PlayerControl extends Component {\n    \n    vMov : number = 0.0;\n    hMov : number = 0.0;\n\n    @property speed : number = 250.0;\n\n    start () {\n        \n\n        systemEvent.on(SystemEvent.EventType.KEY_DOWN, this.onKeyDown, this);\n        systemEvent.on(SystemEvent.EventType.KEY_UP, this.onKeyUp, this);\n        director.getScene().addChild(player);\n\n        var collider = this.getComponent(Collider);\n        collider.on(\"onTriggerEnter\", this.onTriggerEnter, this);\n    }\n\n    onTriggerEnter (event: ICollisionEvent) {\n        if(event.otherCollider.getComponent(pla) != null)\n        {\n            this.node.destroy();\n        }\n    }\n\n    onKeyDown(event: EventKeyboard) {\n\n        switch (event.keyCode)\n        {\n            case KeyCode.ARROW_UP:    this.vMov = this.speed;  break;\n            case KeyCode.ARROW_RIGHT: this.hMov = this.speed;  break;\n            case KeyCode.ARROW_LEFT:  this.hMov = -this.speed; break;\n        }\n    }\n\n    onKeyUp(event: EventKeyboard) {\n\n        switch (event.keyCode)\n        {\n            case KeyCode.ARROW_UP:\n                if (this.vMov > 0)\n                {\n                    this.vMov = 0;\n                }\n            break;\n\n            case KeyCode.ARROW_RIGHT:\n                if (this.hMov > 0)\n                {\n                    this.hMov = 0;\n                }\n                break;\n\n            case KeyCode.ARROW_LEFT:\n                if (this.hMov< 0)\n                {\n                    this.hMov = 0;\n                }\n                break;\n        }\n    }\n\n    update (dt: number) {\n        this.move(dt)\n        this.clampPosition();\n    }\n\n    private move(dt: number) {\n        var pos = this.node.position;\n        pos.set(pos.x + this.hMov * dt, pos.y + this.vMov * dt);\n        this.node.position = pos;\n    }\n\n    private getScreenRect() : Rect\n    {\n        var sprite = this.getComponent(UITransform);\n        var canvas = this.node.parent.getComponent(UITransform);\n        return new Rect(-canvas.width / 2.0 + sprite.width / 2.0,\n                        -canvas.height / 2.0 + sprite.height / 2.0,\n                        canvas.width - sprite.width,\n                        canvas.height - sprite.height);\n    }\n\n    private clampPosition() {\n        var screenRect = this.getScreenRect();\n        var x = clamp(this.node.position.x, screenRect.xMin, screenRect.xMax);\n        var y = clamp(this.node.position.y, screenRect.yMin, screenRect.yMax);\n        this.node.position.set(x, y);\n    }\n\n    \n}\n\n\n"]}